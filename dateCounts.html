<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Date Calculator – Multi Unit</title>
    <link rel="stylesheet" href="css/sidePages.css">
</head>

<body>



    <div class="container">
        <h1>Date Calculator</h1>

        <div class="header">
            <button class="nav-btn" onclick="prevMonth()">← Prev</button>
            <h2 id="monthYear"></h2>
            <button class="nav-btn" onclick="nextMonth()">Next→</button>
        </div>

        <div id="calendar"></div>

        <div class="controls">
            <select id="operation">
                <option value="add">Add</option>
                <option value="subtract">Subtract</option>
            </select>

            <input type="number" id="amount" value="3" min="0" step="1">

            <select id="unit">
                <option value="days">days</option>
                <option value="weeks">weeks</option>
                <option value="months">months</option>
                <option value="years">years</option>
            </select>

            <button onclick="calculate()">Calculate</button>
        </div>

        <div id="result">
            Select a date on the calendar, choose operation / amount / unit, then click Calculate
        </div>
        <div class="btnContainer">
            <a class="btn" href="index.html">BACK</a>
        </div>

    </div>

    <script>
        let currentDate = new Date();     // displayed month/year
        let selectedDate = new Date();    // user-selected date

        function renderCalendar() {
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            document.getElementById('monthYear').textContent =
                currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            // Weekday headers
            ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(day => {
                const div = document.createElement('div');
                div.className = 'day-name';
                div.textContent = day;
                calendar.appendChild(div);
            });

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();

            // Previous month padding
            for (let i = 0; i < firstDay; i++) {
                const cell = document.createElement('div');
                cell.className = 'date-cell other-month';
                calendar.appendChild(cell);
            }

            // Current month
            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                cell.className = 'date-cell';
                cell.textContent = day;

                const thisDate = new Date(year, month, day);

                if (thisDate.toDateString() === today.toDateString()) {
                    cell.classList.add('today');
                }
                if (thisDate.toDateString() === selectedDate.toDateString()) {
                    cell.classList.add('selected');
                }

                cell.onclick = () => {
                    selectedDate = thisDate;
                    renderCalendar();
                };

                calendar.appendChild(cell);
            }
        }

        function prevMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        function calculate() {
            if (!selectedDate) {
                document.getElementById('result').innerHTML = "Please select a date first.";
                return;
            }

            const amount = parseInt(document.getElementById('amount').value) || 0;
            const op = document.getElementById('operation').value;
            const unit = document.getElementById('unit').value;

            const resultDate = new Date(selectedDate);

            let unitText = unit;
            if (amount === 1) unitText = unit.slice(0, -1); // day/week/month/year

            const sign = op === 'add' ? 1 : -1;

            if (unit === 'days') {
                resultDate.setDate(resultDate.getDate() + sign * amount);
            }
            else if (unit === 'weeks') {
                resultDate.setDate(resultDate.getDate() + sign * amount * 7);
            }
            else if (unit === 'months') {
                resultDate.setMonth(resultDate.getMonth() + sign * amount);
            }
            else if (unit === 'years') {
                resultDate.setFullYear(resultDate.getFullYear() + sign * amount);
            }

            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const formatted = resultDate.toLocaleDateString('en-US', options);

            const startFormatted = selectedDate.toLocaleDateString('en-US', {
                month: 'long', day: 'numeric', year: 'numeric'
            });

            const action = op === 'add' ? 'after' : 'before';

            document.getElementById('result').innerHTML = `
        <strong>${formatted}</strong><br>
        is ${amount} ${unitText}${amount === 1 ? '' : ''} ${action}<br>
        ${startFormatted}
      `;
        }

        // Initialize
        window.onload = () => {
            selectedDate = new Date();   // today selected by default
            renderCalendar();
            calculate();                 // show initial example
        };
    </script>

</body>

</html>